def get_rag_prompt(contexts: list, question: str) -> str:
    """Формирует промпт для RAG системы с жёсткими ограничениями."""

    if not contexts or all(not ctx.strip() for ctx in contexts):
        return f"""Вопрос: {question}

У меня нет информации по этому вопросу в документах о ПАО «Транснефть»."""

    context_str = "\n\n".join([
        f"Документ {i + 1}:\n{ctx}"
        for i, ctx in enumerate(contexts) if ctx.strip()
    ])

    # УСИЛЕННЫЙ ПРОМПТ с явными запретами
    prompt = f"""Ты — официальный AI-консультант ПАО «Транснефть».

ВАЖНО:
1. Отвечай ТОЛЬКО на основе документов ниже
2. НЕ использовать информацию не из документов
1. Если вопрос общий (например, "Сколько выручка у компании?"), найди в документах соответствующую информацию и дай полный ответ с указанием года/периода
2. Если конкретных данных нет, но есть релевантная информация - используй её для формирования ответа
3. Если ответа НЕТ в документах - честно скажи: "В предоставленных документах нет информации по этому вопросу"
4. Отвечай чётко, структурированно, с конкретными цифрами и фактами
5. Указывай источник (номер документа) для каждого факта
4. Если информации нет в документах — скажи: "Данной информации нет в документах"
5. Будь кратким (2-5 предложений)

ДОКУМЕНТЫ:
{context_str}

ВОПРОС ПОЛЬЗОВАТЕЛЯ: {question}

Ответ (на русском, структурированно):"""

    return prompt